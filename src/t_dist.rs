const SIG_LEVEL_COUNT: usize = 6;
const DF_MAX: usize = 100;  // Inclusive
const DF_COUNT: usize = DF_MAX + 1;

// The inner indices are the 2-sided critical values for, in order, the
// following significance levels: 0.100, 0.050, 0.025, 0.010, 0.005, 0.001.
//
// Outer indices correspond to (integer) degrees of freedom `df`. For positive
// `df` with 1 <= `df` <= `DF_MAX`, the `df` value is exactly the array index.
// Otherwise, since the t-distribution is approximately normal as `df` → ∞, we
// use the critical values from the normal distribution (at index 0).
static T_DIST_CRIT: [[f64; SIG_LEVEL_COUNT]; DF_COUNT] = [
    [1.2815515655446004, 1.6448536269514729, 1.9599639845400545,
     2.3263478740408408, 2.5758293035489008, 3.0902323061678132],
    [6.3137515148009378, 12.706204736432102, 25.451699579293177,
     63.656741162874042, 127.3213364688721, 636.61924943178542],
    [2.9199855803555175, 4.3026527299112765, 6.2053468234237643,
     9.9248432009180743, 14.089047275548602, 31.599054577039769],
    [2.3533634348018273, 3.1824463052842638, 4.1765348461438601,
     5.840909299756432, 7.4533185051504836, 12.923978636636937],
    [2.1318467813362907, 2.7764451051977996, 3.4954059325169733,
     4.6040948714158976, 5.5975683683221495, 8.6103015813796517],
    [2.0150483726691575, 2.5705818366147399, 3.1633814497486195,
     4.0321429835575362, 4.7733406049069345, 6.8688266398650493],
    [1.9431802803927818, 2.446911848791681, 2.9686866841534627,
     3.7074280213249073, 4.316827103636574, 5.9588161799338542],
    [1.8945786050613054, 2.3646242510103002, 2.8412442550807717,
     3.4994832973505039, 4.0293371776427609, 5.4078825209775641],
    [1.8595480375228428, 2.3060041350333709, 2.7515235937129452,
     3.3553873313333966, 3.8325186853443731, 5.0413054333883647],
    [1.8331129326536337, 2.262157162740992, 2.6850108460045292,
     3.2498355440153701, 3.6896623923042351, 4.7809125859334722],
    [1.8124611228107341, 2.2281388519649385, 2.6337669154010297,
     3.169272667175838, 3.581406202090657, 4.5868938587030597],
    [1.7958848187036696, 2.2009851600829489, 2.5930926824101475,
     3.1058065132211015, 3.496614176741788, 4.4369793382345364],
    [1.7822875556491593, 2.1788128296634182, 2.5600329593015521,
     3.0545395883368709, 3.4284442358308769, 4.3177912836062049],
    [1.7709333959867992, 2.1603686564610132, 2.5326378146335937,
     3.0122758382071839, 3.3724679378582554, 4.2208317277071261],
    [1.7613101357748564, 2.1447866879169277, 2.5095694114796649,
     2.9768427341126604, 3.325695816224211, 4.1404541127382037],
    [1.7530503556925552, 2.131449545559323, 2.4898797034727567,
     2.9467128833386149, 3.2860385700847816, 4.0727651959037914],
    [1.7458836762762404, 2.1199052992210112, 2.4728783224576945,
     2.9207816223499976, 3.2519928739057202, 4.0149963325952651],
    [1.7396067260750676, 2.1098155778331811, 2.458050720377102,
     2.8982305196347173, 3.222449911084329, 3.9651262636083766],
    [1.7340636066175359, 2.1009220402409601, 2.4450056165136753,
     2.8784404727135864, 3.1965742220942057, 3.9216458200058941],
    [1.7291328115213678, 2.0930240544082634, 2.4334402113742128,
     2.8609346064499142, 3.1737245306948507, 3.8834058494833705],
    [1.7247182429207863, 2.0859634472658368, 2.423116539872944,
     2.8453397097768138, 3.1534005328460251, 3.8495162729841845],
    [1.7207429028118777, 2.0796138447276626, 2.4138450165987084,
     2.8313595580171866, 3.1352062453679785, 3.8192771630298386],
    [1.7171443743802424, 2.0738730679040152, 2.4054727462617485,
     2.8187560605963693, 3.1188242068359853, 3.7921306708873037],
    [1.7138715277470478, 2.0686576104190411, 2.3978750646569877,
     2.8073356837675236, 3.1039969631245912, 3.7676268037738825],
    [1.7108820799094282, 2.063898561628021, 2.390949315129387,
     2.796939504772805, 3.0905135487060882, 3.7453986189275259],
    [1.7081407612518991, 2.0595385527532946, 2.3846102008046342,
     2.7874358136758515, 3.0781994605361103, 3.7251439494806462],
    [1.7056179197592731, 2.0555294386428713, 2.3787862662355499,
     2.7787145333289138, 3.0669091164254447, 3.7066117433088879],
    [1.7032884457221269, 2.0518305164802841, 2.3734172009125816,
     2.7706829571216756, 3.0565201088529323, 3.689591713338372],
    [1.7011309342659315, 2.0484071417952441, 2.3684517491687265,
     2.7632624554610659, 3.0469287750505081, 3.6739064006153312],
    [1.6991270265334977, 2.0452296421327034, 2.363846073208296,
     2.7563859036703349, 3.038046744847366, 3.6594050194045287],
    [1.6972608943617384, 2.0422724563012382, 2.3595624587009199,
     2.7499956535670305, 3.0297982236469334, 3.6459586349971094],
    [1.6955187891366654, 2.0395134463964082, 2.3555682821599051,
     2.7440419192941268, 3.022117834308728, 3.6334563497253711],
    [1.6938887540051639, 2.0369333434601011, 2.3518351803763635,
     2.7384814820120829, 3.0149488883537963, 3.6218022598430815],
    [1.6923603138485823, 2.0345152974493383, 2.3483383772574742,
     2.733276642350758, 3.0082419901227535, 3.6109130076361864],
    [1.6909242593357279, 2.0322445093177191, 2.3450561343451777,
     2.7283943670706621, 3.00195390145368, 3.6007157973726653],
    [1.6895724539637715, 2.0301079282503429, 2.3419692993010357,
     2.7238055892080473, 2.9960466119014937, 3.5911467758003437],
    [1.6882977108049171, 2.0280940009804507, 2.3390609325747445,
     2.7194846304499745, 2.990486572384051, 3.5821497014483561],
    [1.687093616710988, 2.0261924630291097, 2.3363159969097822,
     2.715408721549962, 2.9852440597159977, 3.5736748444390583],
    [1.6859544576438146, 2.0243941645751367, 2.3337210976874623,
     2.7115576019130625, 2.9802926466866868, 3.5656780715754675],
    [1.6848751194974001, 2.0226909117347285, 2.3312642646588206,
     2.7079131835176464, 2.9756087577928816, 3.558120081329013],
    [1.6838510113865808, 2.0210753829953378, 2.3289347675691143,
     2.7044592674331502, 2.9711712949059903, 3.5509657608603922],
    [1.682878000411292, 2.0195409639828941, 2.3267229596914332,
     2.7011813035785126, 2.96696132036503, 3.5441836429692786],
    [1.6819523559426006, 2.0180816970958815, 2.3246201444632115,
     2.6980661862199771, 2.962961787478652, 3.5377454453256001],
    [1.6810707018477637, 2.0166921941428138, 2.3226184613423846,
     2.6951020791576692, 2.9591573103668907, 3.5316256778065913],
    [1.6802299753652521, 2.0153675699129416, 2.3207107877282604,
     2.6922782656930169, 2.9555339666050378, 3.525801306486005],
    [1.6794273915744256, 2.0141033848332928, 2.3188906543703403,
     2.6895850193746389, 2.9520791273443923, 3.5202514649701548],
    [1.6786604125916906, 2.0128955952945891, 2.3171521721500166,
     2.6870134922422131, 2.9487813105498697, 3.5149572054810418],
    [1.6779267207755806, 2.0117405104757551, 2.3154899695865017,
     2.684555617866522, 2.9456300537673101, 3.5099012834488579],
    [1.6772241953450402, 2.0106347546964458, 2.3138991340894366,
     2.6822040269502136, 2.9426158034554528, 3.5050679704696961],
    [1.6765508919142635, 2.0095752344892093, 2.3123751668571346,
     2.6799519736315505, 2.9397298184209162, 3.5004428913669514],
    [1.6759050245283318, 2.0085591097152062, 2.3109139278793993,
     2.677793270940843, 2.9369640853037526, 3.4960128818107976],
    [1.6752849498502624, 2.0075837681558824, 2.309511644756534,
     2.6757222341106464, 2.9343112443954764, 3.4917658635336211],
    [1.6746891532047912, 2.0066468031022118, 2.3081648104572814,
     2.6737336306472188, 2.9317645243457044, 3.4876907346569559],
    [1.674116236229432, 2.0057459935369502, 2.3068702004888673,
     2.6718226362410031, 2.9293176845395892, 3.4837772730382537],
    [1.6735649059209434, 2.0048792865665233, 2.3056248355802009,
     2.6699847957348908, 2.9269649641151592, 3.4800160508701143],
    [1.6730339648966599, 2.0040447818101814, 2.3044259588091518,
     2.6682159884861933, 2.9247010367450188, 3.4763983590334542],
    [1.6725223027163512, 2.003240717496698, 2.3032710152426694,
     2.6665123975560632, 2.922520970436306, 3.4729161399297932],
    [1.6720288881322793, 2.0024654580545991, 2.3021576337735028,
     2.6648704822419713, 2.9204201917111492, 3.4695619277046865],
    [1.6715527621536728, 2.0017174830120927, 2.3010836108819639,
     2.6632869538098678, 2.9183944536208228, 3.4663287949309294],
    [1.6710930318274833, 2.0009953770482105, 2.3000468960888565,
     2.6617587534986842, 2.9164398071234015, 3.4632103049518732],
    [1.6706488646505933, 2.000297821058262, 2.2990455788976307,
     2.6602830311506862, 2.9145525754194979, 3.4602004691962973],
    [1.6702194835399258, 1.9996235841149783, 2.2980778770508845,
     2.6588571298174766, 2.9127293308955355, 3.4572937088703615],
    [1.6698041622965287, 1.9989715162223116, 2.2971421259494544,
     2.6574785689006721, 2.910966874370688, 3.4544848205119778],
    [1.6694022215079614, 1.998340541772196, 2.2962367691019936,
     2.6561450297622597, 2.9092622163834219, 3.4517689449609614],
    [1.6690130248403527, 1.9977296536259739, 2.2953603494898469,
     2.6548543427210571, 2.9076125602876028, 3.4491415393563423],
    [1.6686359756775722, 1.9971379077520126, 2.2945115017464968,
     2.6536044752820116, 2.9060152869573019, 3.4465983518219439],
    [1.6682705140701914, 1.9965644183594748, 2.2936889450633289,
     2.6523935082021266, 2.9044679409245102, 3.4441353985439846],
    [1.6679161139614287, 1.996008353475506, 2.2928914767442299,
     2.6512196788529443, 2.9029682181424175, 3.4417489429811776],
    [1.6675722806611732, 1.9954689309194023, 2.2921179663408324,
     2.6500812928169557, 2.9015139541643844, 3.4394354769794822],
    [1.6672385485425929, 1.9949454146328141, 2.2913673503082888,
     2.6489767689254551, 2.9001031127031069, 3.4371917035910733],
    [1.6669144789387706, 1.9944371113297732, 2.2906386271284584,
     2.6479046186679795, 2.8987337779447748, 3.4350145214208019],
    [1.6665996582193987, 1.9939433674345044, 2.2899308528535154,
     2.6468634395039388, 2.897404145122032, 3.4329010103440885],
    [1.6662936960297965, 1.9934635662785831, 2.2892431370282873,
     2.6458519087452737, 2.8961125125846499, 3.4308484184581158],
    [1.6659962236764956, 1.9929971255321668, 2.2885746389542994,
     2.6448687779540596, 2.8948572745399459, 3.4288541501438816],
    [1.665706892645352, 1.9925434948468204, 2.2879245642625912,
     2.6439128678051951, 2.8936369143978831, 3.4269157551303513],
    [1.6654253732396664, 1.9921021536898658, 2.2872921617659272,
     2.6429830633697446, 2.8924499986629049, 3.4250309184639476],
    [1.6651513533271274, 1.9916726093523491, 2.2866767205641931,
     2.6420783097793112, 2.8912951713208126, 3.4231974512971606],
    [1.6648845371855614, 1.9912543951146042, 2.286077567379535,
     2.6411976082359927, 2.8901711342236567, 3.4214132824193011],
    [1.6646246444385244, 1.9908470685550523, 2.2854940641002459,
     2.6403400123362202, 2.88907670014193, 3.419676450460571],
    [1.6643714090726749, 1.9904502099893606, 2.2849256055145717,
     2.6395046246800455, 2.8880107016566852, 3.4179850967078544],
    [1.6641245785296972, 1.9900634210283845, 2.2843716172175164,
     2.6386905937403506, 2.8869720449307632, 3.4163374584769417],
    [1.663883912866253, 1.9896863232444832, 2.2838315536754465,
     2.6378971109690279, 2.8859596915108288, 3.4147318629915775],
    [1.6636491839760925, 1.989318556936819, 2.2833048964347729,
     2.6371234081194737, 2.8849726548664001, 3.4131667217246844],
    [1.6634201748690256, 1.9889597799871794, 2.2827911524623641,
     2.6363687547667607, 2.8840099971851849, 3.4116405251615673],
    [1.6631966790019568, 1.9886096667986737, 2.2822898526065214,
     2.6356324560086688, 2.8830708264028244, 3.4101518379488596],
    [1.6629784996576573, 1.9882679073103779, 2.281800550168418,
     2.634913850332377, 2.8821542934473166, 3.4086992943964316],
    [1.6627654493673443, 1.9879342060816723, 2.2813228195748696,
     2.6342123076330561, 2.8812595896802007, 3.4072815943027228],
    [1.6625573493735013, 1.9876082814405773, 2.2808562551441409,
     2.6335272273718875, 2.8803859445183382, 3.4058974990766351],
    [1.662354029129713, 1.9872898646909389, 2.2804004699372737,
     2.6328580368621983, 2.8795326232215706, 3.4045458286344368],
    [1.6621553258345656, 1.9869786993737681, 2.2799550946881033,
     2.6322041896734416, 2.8786989248329244, 3.4032254569362927],
    [1.661961083996941, 1.9866745405784685, 2.2795197768057354,
     2.6315651641436673, 2.8778841802592323, 3.4019353091093159],
    [1.6617711550302652, 1.9863771543000652, 2.2790941794438351,
     2.6309404619919823, 2.8770877504811208, 3.4006743593550461],
    [1.6615853968734795, 1.9860863168388938, 2.2786779806315618,
     2.6303296070232491, 2.8763090248823233, 3.3994416277672932],
    [1.6614036736367146, 1.9858018142395031, 2.2782708724614307,
     2.6297321439179377, 2.8755474196891204, 3.398236177794602],
    [1.6612258552697992, 1.9855234417658303, 2.2778725603298087,
     2.6291476371006861, 2.8748023765115462, 3.3970571138692138],
    [1.6610518172519093, 1.9852510034099267, 2.2774827622261009,
     2.6285756696816471, 2.874073360978699, 3.3959035791899175],
    [1.6608814403008012, 1.9849843114317696, 2.2771012080670325,
     2.6280158424652225, 2.8733598614611449, 3.3947747536472734],
    [1.6607146101002044, 1.9847231859278835, 2.2767276390727047,
     2.6274677730212406, 2.8726613878740044, 3.3936698518806439],
    [1.6605512170440575, 1.9844674544266925, 2.2763618071814236,
     2.6269310948140245, 2.8719774705548407, 3.3925881214573832],
    [1.6603911559963902, 1.9842169515086832, 2.2760034745005036,
     2.6264054563851862, 2.8713076592109466, 3.3915288411653051],
    [1.6602343260657506, 1.983971518449634, 2.2756524127904934,
     2.6258905205863341, 2.8706515219310758, 3.3904913194103012],
];

#[derive(Debug, Clone, Copy)]
pub enum SigLevel {
    Alpha001,
    Alpha005,
    Alpha010,
    Alpha025,
    Alpha050,
    Alpha100,
}

impl SigLevel {
    fn to_index(&self) -> usize {
        match *self {
            SigLevel::Alpha001 => 5,
            SigLevel::Alpha005 => 4,
            SigLevel::Alpha010 => 3,
            SigLevel::Alpha025 => 2,
            SigLevel::Alpha050 => 1,
            SigLevel::Alpha100 => 0,
        }
    }

    pub fn to_f64(&self) -> f64 {
        match *self {
            SigLevel::Alpha001 => 0.001,
            SigLevel::Alpha005 => 0.005,
            SigLevel::Alpha010 => 0.010,
            SigLevel::Alpha025 => 0.025,
            SigLevel::Alpha050 => 0.050,
            SigLevel::Alpha100 => 0.100,
        }
    }
}

pub fn t_critical_value_2_sided(df: usize, alpha: SigLevel) -> f64 {
    let df_index = if df > DF_MAX { 0 } else { df };

    T_DIST_CRIT[df_index][alpha.to_index()]
}
